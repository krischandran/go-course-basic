<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>panic - аварийная остановка</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css" integrity="sha512-Jk4AqjWsdSzSWCSuQTfYRIF84Rq/eV0G2+tu07byYwHcbTGfdmLrHjUSwvzp5HvbiqK4ibmNwdcG49Y5RGYPTg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-primary: #070709;
            --bg-secondary: #0c0c0f;
            --bg-tertiary: #111114;
            --bg-code: #16161a;
            --text-primary: #e1e2e6;
            --text-secondary: #9d9fa6;
            --accent-blue: #6c9eff;
            --accent-green: #2af16b;
            --accent-red: #ff7b9c;
            --accent-yellow: #ffd93d;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 16px;
            padding-top: calc(env(safe-area-inset-top) + 16px);
            padding-bottom: calc(env(safe-area-inset-bottom) + 100px);
            font-size: 15px;
        }
        .module-badge {
            display: inline-block;
            background: var(--accent-green);
            color: #000;
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        h1 {
            font-size: 1.5rem;
            margin-bottom: 16px;
            color: var(--text-primary);
            line-height: 1.3;
        }
        .lead {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--bg-tertiary);
        }
        h2 {
            font-size: 1.2rem;
            margin: 24px 0 12px;
            color: var(--accent-green);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        h2::before {
            content: '';
            width: 4px;
            height: 20px;
            background: var(--accent-green);
            border-radius: 2px;
        }
        h3 {
            font-size: 1rem;
            margin: 16px 0 8px;
            color: var(--text-primary);
        }
        p { margin-bottom: 12px; color: var(--text-secondary); }
        ul, ol { margin: 0 0 12px 20px; color: var(--text-secondary); }
        li { margin-bottom: 6px; }
        strong { color: var(--text-primary); font-weight: 600; }
        .code-block {
            background: var(--bg-code);
            border-radius: 8px;
            padding: 14px;
            margin: 12px 0;
            overflow-x: auto;
            border: 1px solid var(--bg-tertiary);
        }
        .code-block code {
            background: transparent;
            padding: 0;
            color: inherit;
            font-family: 'JetBrains Mono', 'SF Mono', Consolas, monospace;
            font-size: 13px;
            line-height: 1.5;
        }
        .code-block .comment { color: #5c6370; font-style: italic; }
        .code-block .output {
            border-top: 1px dashed #5c6370;
            margin-top: 10px;
            padding-top: 10px;
            color: var(--accent-green);
        }
        code {
            font-family: 'JetBrains Mono', 'SF Mono', Consolas, monospace;
            background: var(--bg-tertiary);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 13px;
            color: var(--accent-green);
        }
        .info-box {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 14px;
            margin: 12px 0;
            border: 1px solid var(--bg-tertiary);
        }
        .info-box .title {
            font-weight: 600;
            color: var(--accent-blue);
            margin-bottom: 10px;
        }
        .info-box .step {
            display: flex;
            gap: 8px;
            margin-bottom: 6px;
            color: var(--text-secondary);
        }
        .info-box .step-num {
            color: var(--accent-green);
            font-weight: 600;
        }
        .warning-box {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 14px;
            margin: 12px 0;
            border-left: 3px solid var(--accent-red);
        }
        .table-wrapper { overflow-x: auto; margin: 12px 0; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; }
        th, td { padding: 10px 12px; text-align: left; border-bottom: 1px solid var(--bg-tertiary); }
        th { background: var(--bg-secondary); color: var(--accent-green); font-weight: 600; white-space: nowrap; }
        td { color: var(--text-secondary); }
        tr:hover td { background: var(--bg-secondary); }
        .question-card {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 14px;
            margin: 12px 0;
            border-left: 3px solid var(--accent-green);
        }
        .question-card summary {
            cursor: pointer;
            font-weight: 500;
            color: var(--text-primary);
        }
        .question-card p { margin-top: 10px; color: var(--text-secondary); }
        .task-card {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 14px;
            margin: 12px 0;
            border-left: 3px solid var(--accent-blue);
        }
        .task-card summary {
            cursor: pointer;
            font-weight: 500;
            color: var(--text-primary);
        }
        .task-card[open] summary { margin-bottom: 10px; }
        .summary-box {
            background: linear-gradient(135deg, rgba(42, 241, 107, 0.1), rgba(108, 158, 255, 0.1));
            border-radius: 8px;
            padding: 16px;
            margin: 20px 0;
            border: 1px solid var(--accent-green);
        }
        .summary-box h3 { color: var(--accent-green); margin-bottom: 10px; }
        .nav-footer {
            margin-top: 24px;
            padding-top: 16px;
            border-top: 1px solid var(--bg-tertiary);
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 12px;
        }
        .nav-link {
            color: var(--accent-blue);
            text-decoration: none;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .nav-link:hover { text-decoration: underline; }

        /* Override highlight.js background */
        .hljs { background: transparent !important; }
    </style>
</head>
<body>
    <span class="module-badge">Модуль 5: Функции</span>
    <h1>panic - аварийная остановка</h1>
    <p class="lead">Обычные ошибки обрабатываются через <code>error</code>. Но иногда происходит что-то настолько серьёзное, что продолжать работу невозможно.</p>

    <h2>Когда всё совсем плохо</h2>
    <p>Для критических ситуаций в Go есть <code>panic</code>:</p>
    <ul>
        <li>Программист допустил ошибку в логике (баг)</li>
        <li>Нарушен инвариант, который "никогда не должен нарушаться"</li>
        <li>Невозможно инициализировать критически важный компонент</li>
    </ul>

    <h2>panic на самом деле</h2>

    <h3>Что делает panic</h3>
    <p><code>panic</code> немедленно прекращает нормальное выполнение функции:</p>

    <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">main</span>() {
    fmt.Println(<span style="color:#98c379">"Начало"</span>)
    <span style="color:#c678dd">panic</span>(<span style="color:#98c379">"что-то ужасное"</span>)
    fmt.Println(<span style="color:#98c379">"Конец"</span>)  <span class="comment">// Никогда не выполнится</span>
}
<div class="output">Начало
panic: что-то ужасное

goroutine 1 [running]:
main.main()
        /path/to/main.go:7 +0x...</div></code></div>

    <h3>Как работает panic</h3>

    <div class="info-box">
        <div class="title">Последовательность при panic</div>
        <div class="step"><span class="step-num">1.</span> Остановка текущей функции</div>
        <div class="step"><span class="step-num">2.</span> Выполнение всех defer в обратном порядке</div>
        <div class="step"><span class="step-num">3.</span> Возврат в вызывающую функцию</div>
        <div class="step"><span class="step-num">4.</span> Повторение шагов 1-3 вверх по стеку</div>
        <div class="step"><span class="step-num">5.</span> Завершение программы с сообщением об ошибке</div>
    </div>

    <h3>defer выполняется при panic</h3>
    <p>Важная особенность - <code>defer</code> срабатывает даже при <code>panic</code>:</p>

    <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">main</span>() {
    <span style="color:#c678dd">defer</span> fmt.Println(<span style="color:#98c379">"defer в main"</span>)
    problematic()
    fmt.Println(<span style="color:#98c379">"После problematic"</span>)  <span class="comment">// Не выполнится</span>
}

<span style="color:#c678dd">func</span> <span style="color:#61afef">problematic</span>() {
    <span style="color:#c678dd">defer</span> fmt.Println(<span style="color:#98c379">"defer в problematic"</span>)
    <span style="color:#c678dd">panic</span>(<span style="color:#98c379">"ошибка!"</span>)
    fmt.Println(<span style="color:#98c379">"После panic"</span>)  <span class="comment">// Не выполнится</span>
}
<div class="output">defer в problematic
defer в main
panic: ошибка!
...</div></code></div>

    <p>Сначала выполнились все <code>defer</code>, потом программа завершилась.</p>

    <h2>Когда использовать panic</h2>

    <h3>Правильное использование</h3>
    <p><strong>1. Ошибки программиста</strong> - баги, которые нельзя исправить в runtime:</p>
    <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">getElement</span>(slice []<span style="color:#c678dd">int</span>, index <span style="color:#c678dd">int</span>) <span style="color:#c678dd">int</span> {
    <span style="color:#c678dd">if</span> index < <span style="color:#d19a66">0</span> {
        <span style="color:#c678dd">panic</span>(<span style="color:#98c379">"индекс не может быть отрицательным"</span>)
    }
    <span style="color:#c678dd">return</span> slice[index]
}</code></div>

    <p><strong>2. Критическая инициализация</strong> - если без этого программа не может работать:</p>
    <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">mustConnect</span>(addr <span style="color:#c678dd">string</span>) *Connection {
    conn, err := connect(addr)
    <span style="color:#c678dd">if</span> err != <span style="color:#d19a66">nil</span> {
        <span style="color:#c678dd">panic</span>(fmt.Sprintf(<span style="color:#98c379">"не удалось подключиться к %s: %v"</span>, addr, err))
    }
    <span style="color:#c678dd">return</span> conn
}</code></div>

    <p><strong>3. Нарушение инварианта</strong> - "это никогда не должно случиться":</p>
    <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">processType</span>(t <span style="color:#c678dd">int</span>) {
    <span style="color:#c678dd">switch</span> t {
    <span style="color:#c678dd">case</span> <span style="color:#d19a66">1</span>:
        <span class="comment">// обработка типа 1</span>
    <span style="color:#c678dd">case</span> <span style="color:#d19a66">2</span>:
        <span class="comment">// обработка типа 2</span>
    <span style="color:#c678dd">default</span>:
        <span style="color:#c678dd">panic</span>(fmt.Sprintf(<span style="color:#98c379">"неизвестный тип: %d"</span>, t))
    }
}</code></div>

    <h3>Неправильное использование</h3>
    <div class="code-block"><code><span class="comment">// ПЛОХО: обычная ошибка - используй error</span>
<span style="color:#c678dd">func</span> <span style="color:#61afef">divide</span>(a, b <span style="color:#c678dd">int</span>) <span style="color:#c678dd">int</span> {
    <span style="color:#c678dd">if</span> b == <span style="color:#d19a66">0</span> {
        <span style="color:#c678dd">panic</span>(<span style="color:#98c379">"деление на ноль"</span>)  <span class="comment">// Неправильно!</span>
    }
    <span style="color:#c678dd">return</span> a / b
}

<span class="comment">// ХОРОШО: используй error</span>
<span style="color:#c678dd">func</span> <span style="color:#61afef">divide</span>(a, b <span style="color:#c678dd">int</span>) (<span style="color:#c678dd">int</span>, <span style="color:#c678dd">error</span>) {
    <span style="color:#c678dd">if</span> b == <span style="color:#d19a66">0</span> {
        <span style="color:#c678dd">return</span> <span style="color:#d19a66">0</span>, fmt.Errorf(<span style="color:#98c379">"деление на ноль"</span>)
    }
    <span style="color:#c678dd">return</span> a / b, <span style="color:#d19a66">nil</span>
}</code></div>

    <div class="warning-box">
        <p><strong>Правило:</strong> Используй <code>panic</code> только для багов программиста, не для обычных ошибок. Если ситуация может произойти при нормальной работе - используй <code>error</code>.</p>
    </div>

    <h2>Встроенные panic</h2>
    <p>Go сам вызывает panic в некоторых ситуациях:</p>

    <h3>Выход за границы массива/слайса</h3>
    <div class="code-block"><code>arr := []<span style="color:#c678dd">int</span>{<span style="color:#d19a66">1</span>, <span style="color:#d19a66">2</span>, <span style="color:#d19a66">3</span>}
_ = arr[<span style="color:#d19a66">10</span>]  <span class="comment">// panic: runtime error: index out of range</span></code></div>

    <h3>Разыменование nil указателя</h3>
    <div class="code-block"><code><span style="color:#c678dd">var</span> p *<span style="color:#c678dd">int</span>
_ = *p  <span class="comment">// panic: runtime error: invalid memory address</span></code></div>

    <h3>Деление на ноль (для целых чисел)</h3>
    <div class="code-block"><code>a := <span style="color:#d19a66">10</span>
b := <span style="color:#d19a66">0</span>
_ = a / b  <span class="comment">// panic: runtime error: integer divide by zero</span></code></div>

    <h2>panic vs error: сравнение</h2>

    <div class="table-wrapper">
        <table>
            <thead>
                <tr><th>Критерий</th><th>panic</th><th>error</th></tr>
            </thead>
            <tbody>
                <tr><td><strong>Когда</strong></td><td>Баги, невозможные состояния</td><td>Ожидаемые ошибки</td></tr>
                <tr><td><strong>Кто обрабатывает</strong></td><td>Обычно никто (программа падает)</td><td>Вызывающий код</td></tr>
                <tr><td><strong>Восстановление</strong></td><td>Сложно (требуется recover)</td><td>Просто (if err != nil)</td></tr>
                <tr><td><strong>Примеры</strong></td><td>Неверный индекс, nil pointer</td><td>Файл не найден, сеть недоступна</td></tr>
            </tbody>
        </table>
    </div>

    <h3>Примеры выбора</h3>
    <div class="code-block"><code><span class="comment">// panic - это баг программиста</span>
<span style="color:#c678dd">func</span> <span style="color:#61afef">mustParseConfig</span>() Config {
    cfg, err := parseConfig()
    <span style="color:#c678dd">if</span> err != <span style="color:#d19a66">nil</span> {
        <span style="color:#c678dd">panic</span>(<span style="color:#98c379">"конфиг должен быть корректным: "</span> + err.Error())
    }
    <span style="color:#c678dd">return</span> cfg
}

<span class="comment">// error - это нормальная ситуация</span>
<span style="color:#c678dd">func</span> <span style="color:#61afef">loadUserFile</span>(path <span style="color:#c678dd">string</span>) ([]<span style="color:#c678dd">byte</span>, <span style="color:#c678dd">error</span>) {
    data, err := os.ReadFile(path)
    <span style="color:#c678dd">if</span> err != <span style="color:#d19a66">nil</span> {
        <span style="color:#c678dd">return</span> <span style="color:#d19a66">nil</span>, fmt.Errorf(<span style="color:#98c379">"чтение файла: %w"</span>, err)
    }
    <span style="color:#c678dd">return</span> data, <span style="color:#d19a66">nil</span>
}</code></div>

    <h2>Паттерн Must</h2>
    <p>В стандартной библиотеке Go есть функции с префиксом <code>Must</code>:</p>

    <div class="code-block"><code><span class="comment">// regexp.MustCompile - panic при ошибке</span>
re := regexp.MustCompile(<span style="color:#98c379">`\d+`</span>)  <span class="comment">// Если паттерн неверный - panic</span>

<span class="comment">// template.Must - panic при ошибке</span>
tmpl := template.Must(template.New(<span style="color:#98c379">"test"</span>).Parse(<span style="color:#98c379">"{{.Name}}"</span>))</code></div>

    <p>Этот паттерн используется для инициализации, когда ошибка означает баг в коде.</p>

    <h3>Свой Must</h3>
    <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">MustOpen</span>(filename <span style="color:#c678dd">string</span>) *os.File {
    f, err := os.Open(filename)
    <span style="color:#c678dd">if</span> err != <span style="color:#d19a66">nil</span> {
        <span style="color:#c678dd">panic</span>(fmt.Sprintf(<span style="color:#98c379">"не удалось открыть %s: %v"</span>, filename, err))
    }
    <span style="color:#c678dd">return</span> f
}

<span class="comment">// Использование при инициализации</span>
<span style="color:#c678dd">var</span> configFile = MustOpen(<span style="color:#98c379">"config.json"</span>)</code></div>

    <h2>Проверь себя</h2>

    <h3>Вопросы</h3>

    <details class="question-card">
        <summary>Вопрос 1: Чем panic отличается от error?</summary>
        <p><code>panic</code> - для критических ошибок (багов), после которых программа не может продолжать работу. Обычно приводит к завершению программы.<br><code>error</code> - для ожидаемых ошибок, которые можно обработать. Вызывающий код решает, что делать.</p>
    </details>

    <details class="question-card">
        <summary>Вопрос 2: Выполняются ли defer при panic?</summary>
        <p>Да. При panic все defer-функции выполняются в обратном порядке (LIFO), прежде чем программа завершится. Это позволяет корректно освободить ресурсы.</p>
    </details>

    <details class="question-card">
        <summary>Вопрос 3: В каких случаях Go сам вызывает panic?</summary>
        <p>1. Выход за границы массива/слайса<br>2. Разыменование nil указателя<br>3. Деление на ноль (для целых чисел)<br>4. Закрытие закрытого канала<br>5. Отправка в закрытый канал</p>
    </details>

    <details class="question-card">
        <summary>Вопрос 4: Что означает паттерн Must?</summary>
        <p>Функции с префиксом <code>Must</code> вызывают panic при ошибке вместо возврата error. Используются при инициализации, когда ошибка означает баг в коде (например, неверное регулярное выражение в константе).</p>
    </details>

    <h3>Задачи</h3>

    <details class="task-card">
        <summary>Задача 1: Что выведет код?</summary>
        <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">main</span>() {
    fmt.Println(<span style="color:#98c379">"A"</span>)
    <span style="color:#c678dd">defer</span> fmt.Println(<span style="color:#98c379">"B"</span>)
    fmt.Println(<span style="color:#98c379">"C"</span>)
    <span style="color:#c678dd">panic</span>(<span style="color:#98c379">"oops"</span>)
    fmt.Println(<span style="color:#98c379">"D"</span>)
}</code></div>
        <p><strong>Вывод:</strong></p>
        <div class="code-block"><code><div class="output">A
C
B
panic: oops
...</div></code></div>
        <p><strong>Разбор:</strong></p>
        <ol>
            <li>Выводится "A"</li>
            <li>defer запоминает вывод "B"</li>
            <li>Выводится "C"</li>
            <li>panic останавливает выполнение</li>
            <li>Выполняется defer - выводится "B"</li>
            <li>Программа завершается с panic</li>
            <li>"D" никогда не выводится</li>
        </ol>
    </details>

    <details class="task-card">
        <summary>Задача 2: Что выведет код?</summary>
        <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">main</span>() {
    <span style="color:#c678dd">defer</span> fmt.Println(<span style="color:#98c379">"1"</span>)
    <span style="color:#c678dd">defer</span> fmt.Println(<span style="color:#98c379">"2"</span>)
    <span style="color:#c678dd">defer</span> fmt.Println(<span style="color:#98c379">"3"</span>)
    <span style="color:#c678dd">panic</span>(<span style="color:#98c379">"stop"</span>)
}</code></div>
        <p><strong>Вывод:</strong></p>
        <div class="code-block"><code><div class="output">3
2
1
panic: stop
...</div></code></div>
        <p><strong>Разбор:</strong> defer выполняются в обратном порядке (LIFO) даже при panic.</p>
    </details>

    <details class="task-card">
        <summary>Задача 3: Panic или error?</summary>
        <p>Определи, нужен ли panic или error в каждом случае:</p>
        <ol>
            <li>Пользователь ввёл отрицательный возраст</li>
            <li>Программист передал nil в функцию, которая не ожидает nil</li>
            <li>Файл конфигурации не найден</li>
            <li>Switch получил неизвестное значение enum</li>
        </ol>
        <p><strong>Ответы:</strong></p>
        <ol>
            <li><strong>error</strong> - пользовательский ввод может быть некорректным, это ожидаемо</li>
            <li><strong>panic</strong> - это баг программиста, нарушен контракт функции</li>
            <li><strong>error</strong> - файл может отсутствовать, это нормальная ситуация</li>
            <li><strong>panic</strong> - если enum полный, это баг; программист забыл обработать случай</li>
        </ol>
    </details>

    <details class="task-card">
        <summary>Задача 4: Что выведет код?</summary>
        <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">main</span>() {
    fmt.Println(safeCall())
}

<span style="color:#c678dd">func</span> <span style="color:#61afef">safeCall</span>() <span style="color:#c678dd">string</span> {
    <span style="color:#c678dd">defer</span> fmt.Println(<span style="color:#98c379">"defer"</span>)
    <span style="color:#c678dd">return</span> <span style="color:#98c379">"result"</span>
}</code></div>
        <p><strong>Вывод:</strong></p>
        <div class="code-block"><code><div class="output">defer
result</div></code></div>
        <p><strong>Разбор:</strong></p>
        <ol>
            <li><code>safeCall()</code> выполняется</li>
            <li>return готовит значение "result"</li>
            <li>Выполняется defer - выводится "defer"</li>
            <li>Функция возвращает "result"</li>
            <li>main выводит "result"</li>
        </ol>
    </details>

    <details class="task-card">
        <summary>Задача 5: Найди проблему</summary>
        <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">getUserAge</span>(userID <span style="color:#c678dd">int</span>) <span style="color:#c678dd">int</span> {
    user, err := findUser(userID)
    <span style="color:#c678dd">if</span> err != <span style="color:#d19a66">nil</span> {
        <span style="color:#c678dd">panic</span>(<span style="color:#98c379">"пользователь не найден"</span>)
    }
    <span style="color:#c678dd">return</span> user.Age
}</code></div>
        <p><strong>Проблема:</strong> Используется panic для обычной ошибки. Пользователь может не существовать - это нормальная ситуация, не баг.</p>
        <p><strong>Исправление:</strong></p>
        <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">getUserAge</span>(userID <span style="color:#c678dd">int</span>) (<span style="color:#c678dd">int</span>, <span style="color:#c678dd">error</span>) {
    user, err := findUser(userID)
    <span style="color:#c678dd">if</span> err != <span style="color:#d19a66">nil</span> {
        <span style="color:#c678dd">return</span> <span style="color:#d19a66">0</span>, fmt.Errorf(<span style="color:#98c379">"получение возраста: %w"</span>, err)
    }
    <span style="color:#c678dd">return</span> user.Age, <span style="color:#d19a66">nil</span>
}</code></div>
    </details>

    <details class="task-card">
        <summary>Задача 6: Напиши функцию MustPositive</summary>
        <p>Напиши функцию <code>MustPositive(n int) int</code>, которая возвращает n, если n > 0, иначе вызывает panic.</p>
        <div class="code-block"><code><span style="color:#c678dd">func</span> <span style="color:#61afef">MustPositive</span>(n <span style="color:#c678dd">int</span>) <span style="color:#c678dd">int</span> {
    <span style="color:#c678dd">if</span> n <= <span style="color:#d19a66">0</span> {
        <span style="color:#c678dd">panic</span>(fmt.Sprintf(<span style="color:#98c379">"ожидалось положительное число, получено: %d"</span>, n))
    }
    <span style="color:#c678dd">return</span> n
}

<span class="comment">// MustPositive(5)  -> 5</span>
<span class="comment">// MustPositive(-1) -> panic</span></code></div>
    </details>

    <div class="summary-box">
        <h3>Резюме</h3>
        <p><strong>Ключевые идеи:</strong></p>
        <ul>
            <li><code>panic</code> - для критических ошибок (багов), не для обычных ситуаций</li>
            <li>При panic выполняются все defer в обратном порядке</li>
            <li>Go сам вызывает panic при выходе за границы, nil pointer, делении на 0</li>
            <li>Паттерн Must - panic при инициализации вместо возврата error</li>
        </ul>
        <p><strong>Главная ловушка:</strong> Использовать panic для обычных ошибок - это делает код негибким и непредсказуемым.</p>
        <p><strong>Правило:</strong> Если ошибка может произойти при нормальной работе программы - используй error. panic только для багов.</p>
    </div>

    <div class="nav-footer">
        <a href="10-fmt-errorf.html" class="nav-link">← fmt.Errorf</a>
        <a href="12-practice.html" class="nav-link">Практика →</a>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js" integrity="sha512-vLqKjTDJw1L5Vvjcm7xPV49G/OmSEQaVZ0P7jXCuJ9n0lNwFFJ6WfKVQo/h5BdXbEUQxfvSbEQy5EGSCD84YvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        /* global hljs */ /* global Telegram */
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                const tg = Telegram.WebApp;
                tg.ready();
                tg.expand();
                if (tg.BackButton) {
                    tg.BackButton.show();
                    tg.BackButton.onClick(function() {
                        window.history.back();
                    });
                }
            }
            document.querySelectorAll('.code-block code').forEach(function(block) {
                hljs.highlightElement(block);
            });
        });
    </script>
</body>
</html>
